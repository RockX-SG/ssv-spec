package testingutils

import (
	"crypto/ecdsa"
	crand "crypto/rand"
	"crypto/rsa"
	"encoding/hex"
	"math/big"
	mrand "math/rand"

	"github.com/bloxapp/ssv-spec/dkg"
	"github.com/bloxapp/ssv-spec/types"
	"github.com/ethereum/go-ethereum/common"
	"github.com/ethereum/go-ethereum/crypto"
	"github.com/herumi/bls-eth-go-binary/bls"
)

func TestingResharingKeySet() *TestKeySet {
	return &TestKeySet{
		ValidatorSK: skFromHex("65f80c8ae56d2385612e206d53a3db6083b86ffb7ea093ddcf40cb003a60014f"),
		ValidatorPK: pkFromHex("871ac12101b6a8dc6edac502d776a10c01fceedf727b10acb40c6f9de0c977c63879ccb895db7d92ad3d4e77144b64ac"),
		ShareCount:  4,
		Threshold:   3,
		Shares: map[types.OperatorID]*bls.SecretKey{
			1: skFromHex("37a822a012706efb37521c42a6e3efd8a1efb66e0060eb473785f92539fbedb8"),
			2: skFromHex("1000b6658c8f62cafd41ac89321ab498a0b5986e39099c248e3e171e170379c9"),
			3: skFromHex("62020e335b03f3ec3734868dbd072256f8fdb1859e5c9e74d039e8bf0f031aaf"),
			4: skFromHex("73d8d8e7ed8d454d980636e29d7d7ad654ba2021cc0585e3cef540523fde1ff6"),
			5: skFromHex("60bc0a6cf4afeb553d9e319928ba3ff722b97610103d9a76addd5bf299adf2a1"),
			6: skFromHex("6b3fb8aebce28a51ed6b7f4c5481f2833fb429b0fd2cb7df5f40e7bbb3dfc228"),
			7: skFromHex("26cca03eaf459be04d0a4e5ee3bda0824a85de69eaefbc4041af0e1aad46ca82"),
			8: skFromHex("2fce3c93f1974af54a6e789d585f53369a045c666a3aae59ddc5963a17233341"),
		},
		DKGOperators: map[types.OperatorID]struct {
			SK            *ecdsa.PrivateKey
			ETHAddress    common.Address
			EncryptionKey *rsa.PrivateKey
		}{
			1: {
				SK:            ecdsaSKFromHex("96e85c616d446272f387f52f8ce936ee7ac3c65ebe284d1de3c481fa0d147501"),
				ETHAddress:    ethAddressFromHex("535953b5a6040074948cf185eaa7d2abbd66808f"),
				EncryptionKey: rsaSKFromHex("308204a50201000282010100cd2476cbe0327a3d7042206e11b549e9519cf713c2fad9d7f9b6e7625c12d69eb5f8ad354ab1af7b4a5b96684802d28e0123f0a25240954821884b516b1bb368b1b8f721ec49e7471cfcc4d7430f3109eb23941a51e6fe172615c0bed0395b41a7d09830fbe67fd38276405caa064fd6e9f3d3a4989be64fcef96d81e28aba5f078376bc4301610ee4c7532c96f7eaf5c403aaa1ed3ac7d779075f64d37ff261e60717825becb181d042ef2e4642cc8ee330d6812c0d98447e8221dacfd839693a0c368379581f5677f64ce45ceeee98b678e8cdd4caf03428d6063ddd298da55ddd5430735b1da21ca38b1922c04622129e7ac925c03546cc39b3b690951c350203010001028201002df4422c6f9fbf246e3651ff76360f459603bc918fb713ffbeafcb6b8c46a80f4ba25662bec5c912ac5891fbf04db98f18104e027ebc7af47a968690c9969dfd10fae759910e0922340b27a9351b7d17c4b5e6a272c0752108660d14719eb7a3a08d28daa8433d554b3f64319de0e617b5b6ea2d5006747462601bb8e1dfc3d9c92309cc0fd8a576723ae6aa8d8dfbba4872067ecf644c4730c00b00a2b8edd1789e0a0ed5e3b76b5f2d31db12105120e49aaad8eb4a5dabc62adfd0e5368773548538ea66c87ea576d7b7a20a8738c25cb1347e5d0bd1cfe28633faaed97d9c070622ddc3764c00e9ce00fc8325b7d5109e543f606d47cf2d953436099f976102818100ec784008ff79151521baa6b98f32c923efae24ce210a51ecf50874332624fe3c9edaa71698a0c7c99273f7d1759785799aa9649e0e62de74586bc768402a6c30ea7c0a949357ba17e2f52c1d92ad3a069a7bc7c5818ed2a7e0ebc5de7ac2e0f7e5b39dcd5bfa0916f3b42fd3316e1556f5617bd50c09a49f0d819e874d4df60902818100de15da091d66d42da949cb3c6dff2d3818ed86ca0d5105ae063ff705b45f6cfb04f4592dceef66d0975b8bfec6abace5a6124f2d22bc7a568f542b67b6f0d6579c9332b912f98482b82347a1a9adc72a97a9c1d05761bb07fe806a1a3f66a62a158d0e4a918723611627ff4808677fe4cab31eb1e55ab33e46b0a870ac7c1fcd02818100bbdc387b2d82a3161baaae43a298e524d08817a34eaa65358be1007796293375337a5fdddab9789f11e361909d0c1834e883047570d66906232cd4c964988f453933fc2fd6f28ddbe62982b7a7cc48d9f026c0298f68c8c0283707065d9eae9d227654ba4e04d0edd404652e3209d39836ef1032cc12691f16dacff78b99910902818100c67752b54890275772ecde71ef7ed62346aba60414e86e21f9b5da04400ff32d545d2500f9e819c2993097a82455311abd51a96e1597c7e0690ff80624878f9515f8b9a0892370d6fcc59273175694212d0de8854e41a949d8975bba7f2435a47043f11c9476e718111bc757d122e5394a27ce6b7e229302395c0ffb393967950281810094163aa0f45111ebb0539c52d35287b08e2aae25d62ce815e2ca6804689c33949420d7968dba1674aad76b8c501940a5ac32e4574dfe6511adf8ed8e6d6b25ceb2037d3b6bcf5ec11b0b3d0eae638e21796d042473fc8c0ee2a8d480b3053c2069618f1dd551e1a1d8c76327efdc704272e8cedba1e1e51f82308b834ed692f4"),
			},
			2: {
				SK:            ecdsaSKFromHex("6222880ea97bba45d6120626691bc74829741db4ad9300a85a20a925e2c74996"),
				ETHAddress:    ethAddressFromHex("01139beb7ceb4c6a9fd3da779ed69612e489f4e6"),
				EncryptionKey: rsaSKFromHex("308204a50201000282010100c0a177fe5c06b91d0374b66a69a6dda067439085de6248825aebcea570873abecb89f8bbb52aacaebf80d46ee576593f10d804a6ffda4274d6fc19cd2444db74c690adafc2432f13149251e5624d8dd32f6fe034d9a174605105ee5d3f6285a220657cbc1d8f52abf6789eef8be2ab831a9f66c9556a43a10d3064de8f9924ccd818966502ad75079006a267116f5d328871f9040c425b4fb4f3d33985fcfd161ac4fe8e8e7b13205208ff13b353f4a56d394e0b08d1b770ae6f3ad8242c2401433eecf3f0a0fc0e2fe076e21041525c7bd27bd659bc386067d5bd2fa88fd6ca8f89092d598c99f146b996a6ce4667cc4be7fa9c9013ffac90e4b82cb075d95102030100010282010100b85b50be0d5119e51ca39cd9a717de505fc4181326cca55cacabb5f03c0c103afe0da411f1c74fd146d2837d46fac75b464197e244479d06b9a239074e48e04798aa6ab02599aaf9f5dc3ba8ef360e2029ec46860e2b2977ecd36257b80c109d23a83d82c43fa0fd973bc5d0b8ee4cfb828540183c392154878ce35ce5cdc99ae14757e866c4c5cab0625fc1f463a7c6adbc18de8f1410c2ae844b59f443296bb12ccf149d5cc7b85cea10f95569b0526882c1aa19fa197579efcb4dbab0d7580c1b05468c24dc0e1ded552a2ba84db32c610029a5426a9700628ce167f9aaa9ef151ac05cfdd6a66ddbc77d27dde1599098cd677bc7c92fd4f8a3e3e9cbc88102818100e8b2aa080efc1684d7b4de3c02a7e9bf1703c0b361039c4b47470ec1fa5e1be63aae59dc1a6f0661b5485f99ea2d36491c17c250779cea0fb61533c3a5936fce4dd2f32c5d4ea70c9bcaa5304cd76571ad257b80bb8cc2b073ae9964152f9bdd78a7c58b38c893d4a1971b9ac64aa99b8db043d6224db86e8f76183fbc46de2902818100d3eba93f76e2457e4324ae71f1d5adad220ef8b8fe0a37c71a4b40b2e02d3820b091ce43f50239ab49b344cb9c31894286ce6379373553b5ff9a78325f02f1fd47efeee66aece1a48102b268599e89e4d917506718e64b99eaf47bb3ea72406172257139d279383508b6ded3e7ad9a07d275dbe20a174486866c0038e97136e9028181009aafda540d120b2e37eea6252266d8fe0ca094032aa4a9cb69109580e19c99d34c83067d489d3192d65dcc1f970a8321caa908a5513e60621d5aaed48a471e75f84a19190ed5f03a737e1c9da51732fa846d7c52315afb392d4d8dee781ef3f01ffaf758fb606ad558ae08cdb4af815c44ae3e0a2537a138ede9456969117b3102818100a99397f91ace714159c50e7a4b43eb17f17afd783a803ea5e9da71c9312dbe0e1a7c720b5b110ec88bcf11abc42eb7612eb2145338e4493a0770b9e1c4b97c9e6a640a4d031ece686e7b93fb804b2698a346cea5d0fce75e20eec5d5f032c065b98b50912e64a59f7a7baacef242ae50b80e6b86f3002f6b5e4129e46098a19102818029055908c97eb39712df34b9078c6c94b6fa3908c2809c7da36f9ff282e79196180a1da03fa67fda6a000cb6e6cf75707921c2243d8a92cccc150e874b5691c5069bbd9d096b4fc05fa2f5f7ae0af2699057b42c0f2b83236de4542781ea77befbb6985cdc5a878518eef254942330898439723840294369519d7103757465ca"),
			},
			3: {
				SK:            ecdsaSKFromHex("182fc09c07dc35580f1e2c67cb623a71aa2745f79824119a1095c0d373bc1c42"),
				ETHAddress:    ethAddressFromHex("ac8dea7a377f42f31a72cbbf0029048bda105c37"),
				EncryptionKey: rsaSKFromHex("308204a40201000282010100d9d5a9e7aa4d9fc75ed0a5a77540b6026b9ea6913a635edf1f5481f81fd0eabbcc3fea37ed11edd38086983260135d25ed4d2cdbae6892fde3787074e892727602639577c0729e6446bb289ec87f6bc8071a6ad9120cfdc892910f005a56fc466b9f9ebb9adf80e14f13de129b82eeec95d0c9ebba4f3952786d8287ff3146a4e00af5c44aaf1f7611a5791dcf05dfe076733d89bca404722ab9810695bdbc95839f47938367ae5f829b053988cb7d94f72825ede566bcc5aac15b227a1d6899efc428c7829ccb38839196b39aa091e714f8fbad4ed75694ada2f90b70a15b147114d360ccd93767c45db0d6fc3dbc58d024fd1fd2d0fd1301823e7e6432cd4d02030100010282010100a62e9f80f1e668278408eee772c71c537a60bd37fbf0453738c292a885352f6e77a2a6ff65679125125f1c0b0a4a9b7c4caddcb3f7392632746fb4732bde555dfbf296db95c09b5f6aaa6b91bee99e832a10184563c4ef732d85668961620cf178377cb428b1abb3b74d33d4c438be27551fc47b8655dc2833616ffc6a4de0528d7987bf8621f3586016bb47f8e81cf04657f471ce6f0d9d71dd7da3e7ef850af1d20551c0cdbbf77fe6e39dd58434083dd20e7f4eddb4883e67db7f172d26b35bb559aa3c7a9c3a0a46e665857463904973d31443097ce1ec37ba8f15efa9c36201acbda208350dedf94b9c52699a8188267a87bcf48c73dc2149dd2c9f53ad02818100f2d7cf3ae35d2e09b5aad153b8b3819c7b8196491ff936abebc7bd86a967e08af4e21e11865833c50ca6a286eca8e9554dc93b6a2acfdb5f38258f41075a7f8fb0c1240e37d4371bab40d8a6eed71974e7c5f40455018f7b50700c028d7c9d2a26b3e6f234c588081d6821a8bb8518693be4c9eb222dbfb80d3cce0369c03e0f02818100e5a2fe04fb9a0cc637ed2e97df12bd2c6f859dadbb41b2f251ab705419c4049779686b9b6275e57fb2950af2816ac8697ec9ec7a98f5899cdf2b377aa3aa0807d7b609afff7ecbe3d539193593f3d209a539509fbe501251c4d35367ed89fe0aac2bca9b0e0a12e427c506aa3dae1fa98a495f43d4086a33b43c659e2aeddae30281802a5b580af6735f3f544f8a196742f01d8231552c46066af1cbbb58246fd1ed896f332d79730c59634a549a4e9c62cde8121c425fbf3de80e90b5846a1c453db0ab6cd4c4221ac2cdf1adeadc1b16ab9b077e3094bcdafbd2cf71ebb65a455d08681dc2ef8622da1a483ecc7828d50b2ff7c16d32b51073bb3f9bd67723efe3230281805bb0d12cbc29aea01704a56e0eac34cce15ac0b2f5ea2dc183caa8776c3250830aff1eb854802ebae65b8c9b780163347c63b400dfc26ac83073d91b26ee65767c333b7b02d16627faa369e572c6103fb9b140f807cd8103154c2c297b3776305cbebf8f59f3bbc74df9e5c764097aaaff847c7d60d45b5379cc03e73bcced7102818100e82890aff55c0ac12bb1be372cf491be5b20d54438f1ff96b32d00b59c539106478ce6d7b6a1200037a4998c12dc7f6f2479a8ca7c0ab0e8bc019d82047cdb315ed2f20cec4ca1f118ea778ea2bbc3c78f20258fd025115c9451e90120c46f0c95f5aeaefb6cf37428d62811051466d5f1d3301144dc7c9e735c0bcd114625a1"),
			},
			4: {
				SK:            ecdsaSKFromHex("4d3eb49ca01aa6b715a482633fac171f26e957874dd64fe14d8645ddd11346fb"),
				ETHAddress:    ethAddressFromHex("aaaa953af60e4423ad0dadacacab635b095ba255"),
				EncryptionKey: rsaSKFromHex("308204a40201000282010100ad489826fd514cc2845646d59bd0846fdc9b77c58fd3b79dbf07f1a4d0d98f5210f5af483c3a02769927961c9de52acdcc78d7a87e720b574d40f93b5a49095e26e95fd5ccfc3976051c8cb18ff26ac8bd1a95a759b9cc6fa3b75aa77687ce103874680aa922b5f0b65831f9903404da1ce87e15276ab956cf6f72622274edf8a34b743575e870e67368d6e0da4167da9e7027dee219c65c7fd66f8484d249fbaf59534ee553d756dd07f9a50c26334fcfd94391f2b5583b67a8a4c2239b5de55f1b21a8d748312010ac99baebe617183fcb0fcb28b93810344089f3cf2e57969d3c6f72b340ff3c2941fd7b921f314440aec96bba353d848685b305ea2732670203010001028201004dc6627c4580830a5f6975fb9426dffa7132da6c32e4dcea117ed8479871bdb120e994d5c02a6d469bf1379ffa828c56b86a98a908afd94542e861b4f10e0d055443b4fefa354ef918cc3a9dcbb50b96b3c1c5dfca16e99a460a1ac7451d29310095c6c8da2739302437ab9e8ec9ba4fc75fd68f5a14bdc127f3a68c4358e621d0c62b855809c0a97cfd617ce639864be5b5d367eb4ebe37e647856ffe2d7dbc43eb20c8ce2fca5651dcbf682a85848297375d611dcee007d4d1edeaa7eb47431b1ee2b24d929f4587b55368c37adc21adeb72d4bcd4046c00954007177a28a4df766be75bb64a60d43ec02f9306e405485767fd5e010e0670f04c215a662f4102818100d995225d2236d885ae9818e03e947f88ac408f4580bd7166bc17e2e02d58c7b81bcd74e5ded04ae6f1d65b87232b1d7c3a7e3a7b8c8c5202731549d1f9ea39c769364003970d703634f2e0d50a46dccf8f7972756b1bc01fb183bc3915dc9875ccb488a79e09af675fa456a1dfe4489bcc49ac13c3517146e03ff6132d2f1e8702818100cbe11e635ede1aee24e1771d187da30161c521795f7e11a99997828f3257df51ab6a56ab62eae6bf691bddcc39547dc88ce34faeb1254f3c1fe48a1cbb89c21bd56a154533a77da103962fcc5485d82291a828e9a6e04e42ad135bd8dbaf7a30ec4845392517ed89ba23037070943a4cbd257bda17a4f8654f40c26400ef65210281807d5ea3184ad8935623cddbb78a17828cbbc3cf49daee4d6346c9f49dfb4306811cf3fb81602b609d45879fe173f029e324c90ae5998c58ccb486f5ac19764ea88a050a498745e4fc36f2237e5d978b2fc599d2cbb9559a1428f2a107bb830a0e064f97d60d07c39baace4464ad5f1a3f3b2cd00beb25084230806a478e67720d0281810096849ceac01f39c29777dd789d9c23bbe172a843f33c1fce1696c4ccf35dec815f0c22f0651707444955496a7ce8e3f42c0fa5c45304387b2b108ee6a78e0cc07fced1e5453d62827d23642676405a512b37fafc8537149025372597f498989d85d3d5475b1b4f435f287a6188bbe64ec155eb1a185ab308187ab7091da7a00102818100c157cce973ed91393e04048d321042feaed05d9cf4ec21e1cb0ed584ebad80c06810357fc45e9324173c4bbd234288403f15ad58e83184c2dade6e47d897ce100fc6c3bd4e6d1ef4b5af1f6621dd111b27a6f14f8850e89b61c3970234696d1a487322e972cd835d8ff35a0571585c827b3c630f4474e814dfd88dc4bc113477"),
			},
			5: {
				SK:            ecdsaSKFromHex("201381712fd8f14dd974ae6e0def0956518eca5a279ec3940b0f9f4a406dc68c"),
				ETHAddress:    ethAddressFromHex("72d3c5cbd1c7e8edd7a332d6cc66e241fc048f4a"),
				EncryptionKey: rsaSKFromHex("308204a20201000282010100b37f19eee6fee3633598980a91ea1cfbbd2d3863ca6aef6f729ad3ed808364724a4f975b0008f6aa3ad56d8a19b5edf452b0f0e6b52d04a66fe4e6f8ff721a4f2cef6db31bd126d98fa4aa87321443c049d44c191ab5b20ab9c443e42f0b761ecaf1332abb8bc353598ca8e43d7728191efd3775ebc2068f27a345ed4a7e4c701ee60d2298ed6247fb9618c6fe9907ed572fd9bbaabf859dce94430fb054dee4a04dbbacfdd659dabeef5d535d631d50970bda17b085d186107dd697fae36e8df830f19c016d989407e09fbfd8aa11f642a1b6db22c290bf228b8982f96fbaf24510667aae17d3681f0d729eedb152d5ef3c6916f882d3e21b17c9a39c2c503f0203010001028201006d7829b7c2d756946dde777392d3e6033db7b37960bce0f3e64038d9d313cf11c8f24b8bab34cc42bb88e8ba5dbdcfb6bf2bbc6fe7b4e1ee23b5c58bbc36b986ea0fc7a68163883f0d54cecf8f223ec3aa0338b9e2c947213574563776dd9597680bbc39e691717986d6bb361faa692110fe3b71c66bd9963b055fa33d585382d335d02271892d922c1b0d3e5bed2bb69385a9d2e242704bf91640e1df37fa7c4f9bdf4bf0e33448032b55e6616500965d42ae72b9697d9e674533ec5fa8d6f86439682a7e3344bce235315ade3d8b59f478b91f9c5771cd57993ffac241060d54c6c79a95e09e26f37922cbc6381d6dc530cc90ecca2069c9f6e4906467ae8102818100c3a757eacbe74bddbd992ce43b78e2be3bae3c63971531138774dffb8849ed432c7d5b7c7e28b4ea44768d4340f2ed5d60ad790d789e49fc9c65ccd0c52bfb456288801ab0b011994aca888898913a984deb95e1a01212a8325cc649a8b1c76c89d4da515db02f4797c9e809a6098d57dccf91ad8d6d96da0e69b949c36cf0c102818100eadbffafd4fe75645861a322b551c93921348756e91bd43bb7ee895c434a59375f6ea49bc494fbee219d170b686fe48e0c04cd1528b0f57ddad500aaa71bd4cf78ce0ea6cd21f6c205e41a4d78c740454de8b61e56089e15717b76f905581a9db329616e78c7cad0d8bc02b573b2543f3de112ea6977f4f1b19c1b7cc44880ff0281805ff3557e64790e0fb4c7c5e837f254e08e4c28797ec279cae6073f410fd9916dfc078e32437c9b1cb86e9b607c1da6a2c0a2d256f4ec4bc482beb9ef3883153b35d3535fc37ed562a3f7277635bc234c460a5efac391996cbb261c684b3ec45a4a4e04b31a8b28e4a75ff157aa01cd3b65a2b602b2f527a1d0a7b0a2a82069010281801a928fa85e49f810456baea083b1603a0586c2f55364a1abac10e21bbd455138d1a45c1d7fad779fa6cff64685277bcd92908c7fa35dfa38a624c971857cc1a443bfd4aa8cb5160d37cb6a2a6fcae37bb3e7eb8b1d22d67808a1f6811058ba92332e3066e6657c8e0aa7a30ad2af4f96e4326e0875ac6bdb58c417dc12fd3d130281806b7ca82b99544a1bac499c0abc7a48acc8ff14518b39c1bf89c6d36077f1d9f7661f73e19bc4bab2609017bc5722e441729a94a90d83aa3c650715fe6a329e7180efec8b0aafb3b2895a7f6e682cd70dc7663e23ec04cd139835a7758a3b236ff7aa43f713c278e47bc09763436c8749a622891b33eb5d3eb6a15b3710ec2438"),
			},
			6: {
				SK:            ecdsaSKFromHex("02a17f657d3d96eeab9a617bc6b383873fe38a4d150971b967634ee4feac4c8d"),
				ETHAddress:    ethAddressFromHex("34e59dd81b0f832122df98c8cbe8fe4f4f3c31b6"),
				EncryptionKey: rsaSKFromHex("308204a40201000282010100a55bdd8dc443637e6ae1ebc0b25fb0ed2e6865739d414d07848aa9c98f125b547ba5a55154388ffbb032b5952a12f8582dbe66ab7642dba753a62e134a9f9c3242d9d90b4df5b8cdbebd6b045ce643e3a3c07c355dee4eca5960a6dab22f3f66eb2c6ae202c7031837dad87d262d9baeb7b6cee6abaeec3167e8b304fe72a6a76e6ea523ea6bf65ffae841e1ecb5906f9a1da75fd20c0ee8ee2e9dc04408f0363b44ef4e6416eb76388cc11170f15ced581fcb4815dadec64af88453d1f40e7e74967751f8cae049640be1913cf67f8dfa96e48907bff212877d09a555bde3a6f631d447e9604e54448c834f0a4d91a8c5aead1cfa232c8a5b34b3120cb2e6f502030100010282010001e3268833b14135742ad7f1ff173081c481d4869948e184307314b504390569d56f728f97127e3235349ef5f0e0fe8ca319053af7c293973951303d70209a3bc89f8be6a12128d6d05281222f9d41311bf15a799174e2d95463d203b4fced1053a6d2217a3ea33e6784cbebc1bfcb8316fdb326d6d6cc43541847d2cac4ac3a40497ec720d23a90f6edffc7e65fb2ef498eefe3aa6617e04b0cbada9b79ab5e9e4c4cfeb75415e94d36f20f7d9cb6355385fc696ffdcfb931fbe5feca037162ee40e5e30668141658682125e6a10bcf711ee8ea0fd749519f6ef86e3dd81c34ebe3587aa2b0f0906508cecda9bd1122ad7acae5fff3e97f4ba9e8129239900102818100d448c47ddf24040660f82fb40079a54b4fa0a9fa0a6c27fb5046bcf2105e5323e5d894ed84760e9713fec12d0ebcdcfd23c9e95f4cc613d57506a851991c95386c4ee22a65be9bf93902f053bfc6f2627239074341ed6f20f153ae918c184f8451f5420cecc55de28be5a613ecd4435dec5374fc76dd9715a181965ee4a933f502818100c769471be9f6046c414ef8e3429e099b394c9476cb212d4c71bf86adeb03fe2bc60cc4206bacc262dd486df22f7bbf954242bd24e1fae12f39819c1d9946911a591bba24bc6c9c77b316199d64e78786ef9ac5aad1ae855ed909ea67e2da446195161d3051a0ab89d0e1c93831130474647d507f5da7a7861ff648580466070102818100a253aa7d1dde6a7d7e350a35388fcc87d431e5086063e806d291e4f5acf293dcc56b622665bde8d639e1fa51bc0d4b66feb0ed15849d8a99154dabf40982c3d04b71de9bd1057a3b8f0ee23b0850d713d4882b3790f8409c0e2d913596cd1830f482f8a8ed7cd697dfa611e2f69c318f66a142b9b3232adecd8b4c32efe33ae902818033e977469008a8ac19f05a20a78606d02f017da0d34ea6c140d77053345c4cbdce882242a2654e1178b3d3537a030823ee24fba26f65e55b6ae80fe130b6cb2d85c70f15632c0f2ba62679b29cc31d6806564f6121c7021767ff09d3d39da8b192a338240d0bfbbc1bf1bb75726915fecaee48976fa5269a6715b14da08f8301028181009ba547ab2ad11147b1199e32233f6c3f082a96e954772ae11cb0d6a1ff0f4a3c32b1e72d7ba960c2d22959e5b6730fc17d2982747713eb539df68238d010f3c306ecdeaf5fc67da9857adc0794318cbe26678f92bb74c924d4279c7cac5b0d41436846c719407be222ee1c21e021b89e1b8827c2669494464c2c920ade398366"),
			},
			7: {
				SK:            ecdsaSKFromHex("d370c6a295402dfcd3f4d166170b88442db9684268ee4d6e2b9307a1b1df1beb"),
				ETHAddress:    ethAddressFromHex("389d05783094371063d9bf55e46fb67f86c2ee07"),
				EncryptionKey: rsaSKFromHex("308204a30201000282010100cabf1fbe3c15b2ae3b1be1969b79e42099536a361045acbeda677a9e8785a5875663901c6aec1af7e1b26224c9daef72cdba9261dd71285cbb51dfbc7ba415250a58af23248eab20bff2f113a1f432d2d294664ea6be14b449e627707a3284d7840ce4eb394afe79b2cfad16fe3c9dab4b4714be3464f87f1d629cae8d563aae24650bde0a4c13727629e9f48dd856130521b180d16c668fcc2d4ee7bcae5ee69283d35b89587dc78dd9d84ec92c16aca2dd027e06bf1f23bc8a86d407b4eeffd93653af92febd4c4c871d97671cf962a7d07148bc7b475fba6174458c83ab8a4ebe13c7943cfafd36d8a57dfe24485f6404d6f49b133d0231bcb85a0fb68271020301000102820100250e2d750d7241c80a519c37748f209cbca93c3e495712ad87296685d6eb1c47d2083c6c953635ef9c36882d851f18a878e5629fb4635c2726ad5e210ad0007556a0c2d1bf7abbd82e7cee86d210d9c1226fb10b2afa8eba2ccf7de1d6d3a8e7e2e0a06e4578696e40ba283e8d94f2943e1bedb49dcade880d0cdaea2436e05e63e1208fdfc3fb15aa860c0b1d28773069c0a6632889dc7ce29b9b0f24e072cfef47cba908340bba1cba41f3b448f5c3a58b9d65d5fe71670fae27ade554010b88db8c335fb70cf96b29acff4f5bd58babfa8497a19ab96d7b2f92aef31d69b8dddc33cc10013dec7142933c40e0cddb41b5bcf9d6140ec59f83e95c22ab640102818100ce006dc955ca377bc9ef6016772699125cd5f14d74efa8d8f9cbcbdc8e46fba16a6dc04eeac83ae5d0cbfad326c1da6baff21b94305218ed58cb451f6bffeea56824b815f979562d0083a49990977281dca2308e75496a65904a22b1f34b6c8ec73784a84b3d6f436817bf7818d7533f6e22b4515eecd23e7ab35a590978ac2102818100fbf471f254c2f1164ffdb3433d8efaaa34f27413693418673506a4a01046fe6238a262e11b9cc97b8680eb96f1859754956840c6752cca97ff0388bf250c8904de425b76770f3da648664bb4185e02d968b12b2e53a04065d3779550f69c1f8f181bf5d53655611da27d9b753e7ca530b9ce28a18b9d877ef98ecc69d5a68c51028180517a27f22705693683e332cd0fe96b47b10249838a49b42dc5770eb5b86c68e02a1928a3ce06ce0cd1adac1251d5008ff132402837887125872636bbbbdaa94830cdbd25abdb8af317adf9af675a0f473fbdc298c5d8f8c51cf1c5913e9a49609b78e0f63374240ab424186de6dd5ba6cde7da0c09108003884261ecaf6b54210281804dae6a4b5ad2d7de173f933b92093943ad1b6baa686f456edcac75a95c1b6767052b1bed67c40962ea6f69339ab7a396d291d816d81dbd40ebc13d3221cc219abca41ceb037e5175a930d0fa6fe0dc6407a1483cfa4f984b4ccdbbddc08b1637da2914bc6e0a18ed38221e022207f02e7bbb124fec69df52c8c2bc478d35d26102818100b80d709ef76d0c32c9ecd6df6d08bb00d4f5dfde5593c8bbeb11873819d191ec2e1cef35e403f5e803a325c62fbc2440b583f05c29d3820471659e5cd1ac2c7d12b1e07ccc116f9e59c7a1ea5e40149b4011603f0fbdcf8543efb3514957d300188e2074eeb297eac178339fd06a37ad81d6908d50218cc1c7fe40428edb7a4b"),
			},
			8: {
				SK:            ecdsaSKFromHex("f930a907fe0cc4eff82a85498dbc1e6405f42e9410092196dc76b6c8912c7bc1"),
				ETHAddress:    ethAddressFromHex("4f1bee79773989347e553cfbb853736d027fb84f"),
				EncryptionKey: rsaSKFromHex("308204a30201000282010100cc06c90a7c81a8e2fc6d5fbcb25537b75c1c22b581a761f8fd60612cd03e19efe8eb75a0034e61a44711562d173302824be4f3ab42f0d87410d88c515634044a4277c0ac724b760e48e46a0409983419b01d40881e16545e2041102ea4b6c38134dd56431945c5b3489341f5027e3f74ea7f577e376e7d31a3d6fcfa21fd7606b8601df1a37ee1696d32782132b59c6ba6d7e3e987859cb1554186fcdde258267cd3a41c0ec7a085bfb891ef969c6d39b4a96c4539e77dbe4430c401a4eee1464b377d9e0d9b26989b4107be0288332ef10c8dae4c1a992cf2a220102d7f54b0d492856a19dadece78e945dd12f7733948a9ef57c1f1fca9ffd771ff41efd4f30203010001028201005247d24016623bf7fe912570f602840bc06be05b8ec43030b80e6c622441473887989dc1405415f0a870876e7bd2a88a5f8d1fefcb7951f1ccf167f54d6c80e669d3ddb22e0ddcb87a1113e838ee56e49d2fcedc9635af249ea15ea350ee1bfe3991a1be41acefc413dabf58cdfe981cd08d367dc2611ec02c3101a8e6984f4641a1af1a2d9cdd3d71039aa72fd38b0da40c09f4f16ecdcf1f32534362177ea95ec5cd019d8c02cad674aee732e302b2dfa6279b19302522bec94855296ab3a4aae26381c00581ae931d67ff8f0cf2340d72af32002a8d6d2386e57be40dd078746730705077d6f7e07efe4c425512863779ef1f567ae02f5db4fe01ad77220102818100f731ca7f8a7675ff7da2cda64d7da75012479ceb4549c23016a1fa809947b7f7dc6416708e87489bab9fd77bfa94ceafeb31e0c1f6dd8c7da8c376e63a7f987c1af21681f8003d5794b157388030c0ba6af33973b99c6a901fe086eeb6bdba4e1d2b696b650afc0e956c57173044205e6bcece1334a9a3028da7133ae859a27302818100d34b5686f45515dd4b0b6fb7a41f310d68a6891e93b6ee43d36ca288934dbb3295849ce1ee44a404b8e0fb6d1a41550fc77b27c6204607eda34fa1c708b95a3120388e2e79115a9e2385c2a4f08b2871da9796c8bac7f943ea9062391a2456319e973d8d4b5496c1993a1c7a85cc9880ff10b9ecf4b50f1bcb7d742f9423e38102818056e53be805c68ac85b63e5a2f64e9b883c44cc56b02eb382b01214bb2c26d7f6db949b86c9b3a8c4805a5a278cf8ce876cc845d8296dcc3b481e1e27e49c81ffee80f7848ca798e8b6ae7898b6076d589acc11802ad95f6476b038fea562a0a16103a7b546f9cb8d5cdd8ee7e9e1a8f7483294a28fbaaa40f586abede34bcf1d0281805e800068055914994f9a02d2305e1ef32f4de45fbf92fe476984d9c0999917534d59ed4c82e342343677b11b9fb57e94bb1412bae2ee4f5772460845db5a02c39bf48f6aab8d1e6941dbee2d14c438478b8b66cdc9f3ec40fae4ae79797eacea2e52d81d9c866d9292b451ce5e8f1dd9fbba005dc12845649a0336f69c9bdc8102818100acbc4f8dca8dfb22bbcb39d335473b3ee33464bd24838c798338c78e5594c9a4bc69b2d2e1af88c1836baf196e82e26bae14603e4d00f8e005e7619912ac4dd95b9b33e1960f9cd29994fdfe2958a2ecd3bfa359abc29452b2f933c6f6c53b4a0ba212e642b26d39fefe586763379f8a937e0694474445103146cb906d78c8d9"),
			},
		},
	}
}

func SignDKGMsg2(sk *ecdsa.PrivateKey, opID types.OperatorID, msg *dkg.Message) *dkg.SignedMessage {
	signedMessage := &dkg.SignedMessage{
		Message: msg,
		Signer:  opID,
	}

	root, err := signedMessage.GetRoot()
	if err != nil {
		panic(err)
	}

	sig, err := crypto.Sign(root, sk)
	if err != nil {
		panic(err)
	}

	signedMessage.Signature = sig
	return signedMessage
}

type TestOutcome struct {
	KeygenOutcome TestKeygenOutcome
	BlameOutcome  TestBlameOutcome
}

type TestKeygenOutcome struct {
	ValidatorPK     string
	Share           map[uint32]string
	OperatorPubKeys map[uint32]string
}

func (o TestKeygenOutcome) ToKeygenOutcomeMap(threshold uint64, operators []uint32) map[uint32]*dkg.KeyGenOutput {
	m := make(map[uint32]*dkg.KeyGenOutput)

	opPublicKeys := make(map[types.OperatorID]*bls.PublicKey)
	for _, operatorID := range operators {

		pk := &bls.PublicKey{}
		_ = pk.DeserializeHexStr(o.OperatorPubKeys[operatorID])
		opPublicKeys[types.OperatorID(operatorID)] = pk

		share := o.Share[operatorID]
		sk := &bls.SecretKey{}
		_ = sk.DeserializeHexStr(share)

		vk, _ := hex.DecodeString(o.ValidatorPK)

		m[operatorID] = &dkg.KeyGenOutput{
			Share:           sk,
			ValidatorPK:     vk,
			OperatorPubKeys: opPublicKeys,
			Threshold:       threshold,
		}
	}

	return m
}

func ResetRandSeed() {
	src := mrand.NewSource(1)
	src.Seed(12345)
	crand.Reader = mrand.New(src)
}

func GetRandRequestID() dkg.RequestID {
	requestID := dkg.RequestID{}
	for i := range requestID {
		rndInt, _ := crand.Int(crand.Reader, big.NewInt(255))
		if len(rndInt.Bytes()) == 0 {
			requestID[i] = 0
		} else {
			requestID[i] = rndInt.Bytes()[0]
		}
	}
	return requestID
}

type TestBlameOutcome struct {
	Valid        bool
	BlameMessage []byte
}
